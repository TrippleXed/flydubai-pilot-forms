<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>flydubai Pilot Onboarding System</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    
    :root{ 
      /* flydubai Official Brand Colors */
      --bg: linear-gradient(135deg, #6d28d9 0%, #7c3aed 12%, #8b5cf6 25%, #a855f7 37%, #c084fc 50%, #6366f1 62%, #8b5cf6 75%, #9333ea 87%, #7c3aed 100%);
      --card: #ffffff; 
      --ink: #0f172a; 
      --muted: #64748b; 
      --accent: #3b82f6; 
      --accent-light: #60a5fa;
      --line: #e2e8f0; 
      --flydubai-blue: #3b82f6;
      --flydubai-orange: #f97316;
      --flydubai-navy: #1e3a8a;
      --flydubai-light-blue: #dbeafe;
      --aviation-silver: #94a3b8;
      --success: #059669;
      --warning: #d97706;
      --expired: #dc2626;
      --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4), 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }
    
    * { box-sizing: border-box; }
    
    html, body {
      height: 100%;
      scroll-behavior: smooth;
      margin: 0;
      padding: 0;
    }
    
    body {
      background: var(--bg);
      background-attachment: fixed;
      background-size: 100% 100vh;
      color: var(--ink);
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 14px;
      line-height: 1.6;
      font-weight: 400;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
    }
    
    .card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 24px;
      box-shadow: var(--shadow);
      overflow: hidden;
      position: relative;
      margin-bottom: 20px;
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: linear-gradient(90deg, var(--flydubai-blue) 0%, var(--flydubai-orange) 50%, var(--flydubai-blue) 100%);
    }
    
    /* Header */
    .header {
      padding: 16px 40px;
      border-bottom: 2px solid var(--line);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 30%, #f8fafc 70%, #f1f5f9 100%);
      position: relative;
      min-height: 100px;
    }
    
    .header .logo {
      width: 300px;
      height: 60px;
      background-image: url('Flydubai-Logo.png');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: left center;
    }
    
    .header h1 {
      margin: 0;
      font-size: 24px;
      font-weight: 700;
      letter-spacing: -0.025em;
      color: var(--flydubai-navy);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      line-height: 1.2;
      text-align: center;
    }
    
    /* Progress Bar */
    .progress-container {
      padding: 20px 40px;
      background: #f8fafc;
      border-bottom: 1px solid var(--line);
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e2e8f0;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 16px;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--flydubai-blue) 0%, var(--flydubai-orange) 100%);
      border-radius: 4px;
      transition: width 0.3s ease;
      width: 0%;
    }
    
    .progress-steps {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      font-weight: 500;
    }
    
    .step {
      display: flex;
      align-items: center;
      color: var(--muted);
    }
    
    .step.active {
      color: var(--flydubai-blue);
      font-weight: 600;
    }
    
    .step.completed {
      color: var(--success);
    }
    
    .step-number {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--line);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 700;
      margin-right: 8px;
    }
    
    .step.active .step-number {
      background: var(--flydubai-blue);
    }
    
    .step.completed .step-number {
      background: var(--success);
    }
    
    /* Form Steps */
    .form-step {
      display: none;
      padding: 40px;
      animation: fadeIn 0.3s ease;
    }
    
    .form-step.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .step-title {
      font-size: 28px;
      font-weight: 700;
      color: var(--flydubai-navy);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }
    
    .step-subtitle {
      font-size: 16px;
      color: var(--muted);
      margin-bottom: 32px;
      line-height: 1.5;
    }
    
    /* Form Elements */
    .form-grid {
      display: grid;
      gap: 24px;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      margin-bottom: 32px;
    }
    
    .form-section {
      margin-bottom: 32px;
    }
    
    .section-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--flydubai-navy);
      margin-bottom: 16px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--line);
    }
    
    label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 14px;
      color: var(--flydubai-navy);
      letter-spacing: 0.025em;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 14px 16px;
      border-radius: 12px;
      border: 2px solid var(--line);
      background: #ffffff;
      color: var(--ink);
      font-size: 14px;
      font-weight: 500;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      transition: all 0.2s ease-in-out;
      font-family: inherit;
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--flydubai-blue);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1), 0 0 0 3px rgba(59, 130, 246, 0.1);
      transform: translateY(-1px);
    }
    
    .required {
      color: var(--expired);
    }
    
    /* File Upload */
    .upload-area {
      border: 2px dashed var(--line);
      border-radius: 12px;
      padding: 32px;
      text-align: center;
      background: #f8fafc;
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .upload-area:hover {
      border-color: var(--flydubai-blue);
      background: var(--flydubai-light-blue);
    }
    
    .upload-area.dragover {
      border-color: var(--flydubai-orange);
      background: #fef3f2;
    }
    
    .upload-icon {
      font-size: 48px;
      margin-bottom: 16px;
    }
    
    .file-list {
      margin-top: 16px;
    }
    
    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      background: white;
      border: 1px solid var(--line);
      border-radius: 8px;
      margin-bottom: 8px;
    }
    
    .file-info {
      display: flex;
      align-items: center;
    }
    
    .file-icon {
      margin-right: 12px;
      font-size: 20px;
    }
    
    .file-details {
      flex: 1;
    }
    
    .file-name {
      font-weight: 500;
      margin-bottom: 2px;
    }
    
    .file-size {
      font-size: 12px;
      color: var(--muted);
    }
    
    .file-status {
      display: flex;
      align-items: center;
      font-size: 12px;
      font-weight: 500;
    }
    
    .file-status.uploading {
      color: var(--warning);
    }
    
    .file-status.completed {
      color: var(--success);
    }
    
    .file-status.error {
      color: var(--expired);
    }
    
    /* Buttons */
    .btn {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border: 2px solid var(--line);
      padding: 12px 24px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      letter-spacing: 0.025em;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      position: relative;
      overflow: hidden;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-family: inherit;
    }
    
    .btn:hover {
      border-color: var(--flydubai-blue);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    .btn.primary {
      background: linear-gradient(135deg, var(--flydubai-blue) 0%, var(--accent-light) 100%);
      border-color: var(--flydubai-blue);
      color: #ffffff;
      font-weight: 700;
    }
    
    .btn.primary:hover {
      box-shadow: 0 6px 20px rgba(30, 64, 175, 0.4);
    }
    
    .btn.secondary {
      background: linear-gradient(135deg, var(--flydubai-orange) 0%, #fb923c 100%);
      border-color: var(--flydubai-orange);
      color: #ffffff;
      font-weight: 700;
    }
    
    .btn.secondary:hover {
      box-shadow: 0 6px 20px rgba(249, 115, 22, 0.4);
    }
    
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    /* Navigation */
    .form-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 24px 40px;
      border-top: 1px solid var(--line);
      background: #f8fafc;
    }
    
    .nav-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .nav-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .auto-save-status {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      align-items: center;
    }
    
    .auto-save-status.saving {
      color: var(--warning);
    }
    
    .auto-save-status.saved {
      color: var(--success);
    }
    
    /* Recovery Banner */
    .recovery-banner {
      background: linear-gradient(135deg, #fef3f2 0%, #fee2e2 100%);
      border: 1px solid #fecaca;
      border-radius: 12px;
      padding: 16px 20px;
      margin-bottom: 24px;
      display: none;
    }
    
    .recovery-banner.show {
      display: block;
    }
    
    .recovery-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .recovery-message {
      display: flex;
      align-items: center;
      font-weight: 500;
      color: var(--expired);
    }
    
    .recovery-actions {
      display: flex;
      gap: 12px;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .container {
        margin: 10px;
        padding: 10px;
      }
      
      .header {
        padding: 16px 20px;
        flex-direction: column;
        text-align: center;
      }
      
      .header h1 {
        position: static;
        transform: none;
        margin-top: 12px;
      }
      
      .header .logo {
        width: 200px;
        height: 40px;
      }
      
      .form-step {
        padding: 20px;
      }
      
      .form-navigation {
        padding: 16px 20px;
        flex-direction: column;
        gap: 16px;
      }
      
      .nav-left, .nav-right {
        width: 100%;
        justify-content: center;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .progress-steps {
        font-size: 10px;
      }
      
      .step-number {
        width: 16px;
        height: 16px;
        font-size: 8px;
      }
    }
    
    /* Loading States */
    .loading {
      opacity: 0.6;
      pointer-events: none;
    }
    
    .spinner {
      border: 2px solid #f3f3f3;
      border-top: 2px solid var(--flydubai-blue);
      border-radius: 50%;
      width: 16px;
      height: 16px;
      animation: spin 1s linear infinite;
      margin-right: 8px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Original Form Specific Styles */
    .section {
      margin-bottom: 30px;
    }

    .section table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      background: white;
    }

    .section table th,
    .section table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
      vertical-align: middle;
    }

    .section table th {
      background-color: var(--flydubai-blue);
      color: white;
      font-weight: bold;
      font-size: 14px;
    }

    .section table tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .section table input[type="text"],
    .section table input[type="date"],
    .section table select {
      width: 100%;
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 13px;
      box-shadow: none;
      transform: none;
    }

    .section table input[type="text"]:focus,
    .section table input[type="date"]:focus,
    .section table select:focus {
      border-color: var(--flydubai-blue);
      box-shadow: 0 0 3px rgba(59, 130, 246, 0.2);
      transform: none;
    }

    .footer-fields {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      margin-top: 20px;
      padding: 15px;
      background-color: #f0f8ff;
      border-radius: 8px;
      border: 1px solid var(--line);
    }

    .footer-field {
      flex: 1;
      min-width: 200px;
    }

    .footer-field label {
      display: block;
      font-weight: bold;
      margin-bottom: 5px;
      color: var(--flydubai-navy);
      font-size: 14px;
    }

    .footer-field input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
      box-shadow: none;
      transform: none;
    }

    .footer-field input:focus {
      border-color: var(--flydubai-blue);
      box-shadow: 0 0 3px rgba(59, 130, 246, 0.2);
      transform: none;
    }

    .heavy-jet-indicator {
      display: inline-block;
      background-color: #28a745;
      color: white;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: bold;
      margin-left: 10px;
      vertical-align: middle;
    }

    .other-notes {
      margin-top: 10px;
      display: none;
    }

    .other-notes input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
      box-shadow: none;
      transform: none;
    }

    .other-notes input:focus {
      border-color: var(--flydubai-blue);
      box-shadow: 0 0 3px rgba(59, 130, 246, 0.2);
      transform: none;
    }

    .aircraft-section {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background-color: #f9f9f9;
    }

    .aircraft-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }

    .aircraft-header h4 {
      margin: 0;
      color: var(--flydubai-navy);
      font-size: 16px;
    }

    .remove-aircraft {
      background: #dc2626;
      color: white;
      border: none;
      padding: 4px 8px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      margin-left: auto;
    }

    .remove-aircraft:hover {
      background: #b91c1c;
    }

    /* Original form styles from flighttimeexpform.html */
    .section-h {
      font-size: 18px;
      font-weight: 600;
      color: var(--flydubai-navy);
      margin-bottom: 16px;
      border-bottom: 2px solid var(--flydubai-blue);
      padding-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .grand {
      display: flex;
      gap: 32px;
      flex-wrap: wrap;
      margin: 24px 0;
      padding: 20px;
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border-radius: 12px;
      border: 1px solid var(--line);
    }

    .kpi {
      font-size: 16px;
      font-weight: 500;
      color: var(--flydubai-navy);
    }

    .kpi b {
      font-size: 20px;
      font-weight: 700;
      color: var(--flydubai-blue);
      margin-left: 8px;
    }

    .summary {
      margin: 32px 0;
      padding: 24px;
      background: linear-gradient(135deg, #fefefe 0%, #f9fafb 100%);
      border-radius: 16px;
      border: 2px solid var(--line);
    }

    .summary table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
    }

    .summary table th,
    .summary table td {
      border: 1px solid #ddd;
      padding: 12px 8px;
      text-align: center;
      vertical-align: middle;
    }

    .summary table th {
      background-color: var(--flydubai-blue);
      color: white;
      font-weight: bold;
      font-size: 14px;
    }

    .summary table input[type="text"] {
      width: 80px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      text-align: center;
      font-size: 13px;
    }

    .controls.no-print {
      text-align: center;
      margin: 24px 0;
    }

    .controls.no-print .btn {
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
  </style>
</head>
<body>
  <script>
    // ===== Password Protection =====
    (function() {
      const FORM_PASSWORD = "FlightTime2025";
      let attempts = 0;
      const maxAttempts = 3;
      
      function checkPassword() {
        const userPassword = prompt("Enter access code to continue:");
        
        if (userPassword === null) {
          document.body.innerHTML = `
            <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: linear-gradient(135deg, #6d28d9 0%, #7c3aed 12%, #8b5cf6 25%, #a855f7 37%, #c084fc 50%, #6366f1 62%, #8b5cf6 75%, #9333ea 87%, #7c3aed 100%);">
              <div style="text-align: center; background: white; padding: 40px; border-radius: 20px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);">
                <h1 style="color: #1e3a8a; margin-bottom: 20px;">Access Required</h1>
                <p style="color: #64748b; margin-bottom: 30px;">This form requires an access code to continue.</p>
                <button onclick="location.reload()" style="background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer;">Try Again</button>
              </div>
            </div>
          `;
          return;
        }
        
        if (userPassword === FORM_PASSWORD) {
          return;
        } else {
          attempts++;
          if (attempts >= maxAttempts) {
            document.body.innerHTML = `
              <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: linear-gradient(135deg, #6d28d9 0%, #7c3aed 12%, #8b5cf6 25%, #a855f7 37%, #c084fc 50%, #6366f1 62%, #8b5cf6 75%, #9333ea 87%, #7c3aed 100%);">
                <div style="text-align: center; background: white; padding: 40px; border-radius: 20px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);">
                  <h1 style="color: #dc2626; margin-bottom: 20px;">Access Denied</h1>
                  <p style="color: #64748b; margin-bottom: 30px;">Too many incorrect attempts. Please contact your administrator for the correct access code.</p>
                  <p style="color: #64748b; font-size: 14px;">Contact: jason.cameron@flydubai.com</p>
                </div>
              </div>
            `;
            return;
          } else {
            alert(`Incorrect access code. ${maxAttempts - attempts} attempt(s) remaining.`);
            checkPassword();
          }
        }
      }
      
      checkPassword();
    })();
  </script>

  <div class="container">
    <div class="card">
      <!-- Header -->
      <div class="header">
        <div class="logo"></div>
        <h1>Pilot Onboarding System</h1>
      </div>

      <!-- Progress Bar -->
      <div class="progress-container">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-steps">
          <div class="step active" data-step="1">
            <div class="step-number">1</div>
            <span>Personal Info</span>
          </div>
          <div class="step" data-step="2">
            <div class="step-number">2</div>
            <span>Flight Experience</span>
          </div>
          <div class="step" data-step="3">
            <div class="step-number">3</div>
            <span>Documentation</span>
          </div>
          <div class="step" data-step="4">
            <div class="step-number">4</div>
            <span>Review & Submit</span>
          </div>
        </div>
      </div>

      <!-- Recovery Banner -->
      <div class="recovery-banner" id="recoveryBanner">
        <div class="recovery-content">
          <div class="recovery-message">
            <span>üìã</span>
            <span style="margin-left: 8px;">Previous session found. Would you like to continue where you left off?</span>
          </div>
          <div class="recovery-actions">
            <button class="btn" onclick="clearSession()">Start Fresh</button>
            <button class="btn primary" onclick="recoverSession()">Continue</button>
          </div>
        </div>
      </div>

      <!-- Step 1: Personal Information -->
      <div class="form-step active" data-step="1">
        <h2 class="step-title">üë®‚Äç‚úàÔ∏è Personal Information</h2>
        <p class="step-subtitle">Let's start with your basic information. All fields marked with <span class="required">*</span> are required.</p>
        
        <div style="display: grid; gap: 28px; grid-template-columns: minmax(320px, 1fr) minmax(240px, 1fr) minmax(220px, 1fr); margin-bottom: 32px;">
          <div>
            <label for="pilotName">Name <span class="required">*</span></label>
            <input id="pilotName" type="text" placeholder="e.g., Jane D. Pilot" required>
          </div>
          <div>
            <label for="designation">Designation <span class="required">*</span></label>
            <select id="designation" required>
              <option value="">Select‚Ä¶</option>
              <option>Captain</option>
              <option>First Officer</option>
              <option>Second Officer</option>
              <option>Cadet</option>
            </select>
          </div>
          <div>
            <label for="doj">Date of Joining <span class="required">*</span></label>
            <input id="doj" type="date" required>
          </div>
        </div>

        <div class="form-grid">
          <div>
            <label for="nationality">Nationality <span class="required">*</span></label>
            <select id="nationality" required>
              <option value="">Select your nationality</option>
              <option value="AF">Afghanistan</option>
              <option value="AL">Albania</option>
              <option value="DZ">Algeria</option>
              <option value="AS">American Samoa</option>
              <option value="AD">Andorra</option>
              <option value="AO">Angola</option>
              <option value="AI">Anguilla</option>
              <option value="AQ">Antarctica</option>
              <option value="AG">Antigua and Barbuda</option>
              <option value="AR">Argentina</option>
              <option value="AM">Armenia</option>
              <option value="AW">Aruba</option>
              <option value="AU">Australia</option>
              <option value="AT">Austria</option>
              <option value="AZ">Azerbaijan</option>
              <option value="BS">Bahamas</option>
              <option value="BH">Bahrain</option>
              <option value="BD">Bangladesh</option>
              <option value="BB">Barbados</option>
              <option value="BY">Belarus</option>
              <option value="BE">Belgium</option>
              <option value="BZ">Belize</option>
              <option value="BJ">Benin</option>
              <option value="BM">Bermuda</option>
              <option value="BT">Bhutan</option>
              <option value="BO">Bolivia</option>
              <option value="BA">Bosnia and Herzegovina</option>
              <option value="BW">Botswana</option>
              <option value="BV">Bouvet Island</option>
              <option value="BR">Brazil</option>
              <option value="IO">British Indian Ocean Territory</option>
              <option value="BN">Brunei Darussalam</option>
              <option value="BG">Bulgaria</option>
              <option value="BF">Burkina Faso</option>
              <option value="BI">Burundi</option>
              <option value="KH">Cambodia</option>
              <option value="CM">Cameroon</option>
              <option value="CA">Canada</option>
              <option value="CV">Cape Verde</option>
              <option value="KY">Cayman Islands</option>
              <option value="CF">Central African Republic</option>
              <option value="TD">Chad</option>
              <option value="CL">Chile</option>
              <option value="CN">China</option>
              <option value="CX">Christmas Island</option>
              <option value="CC">Cocos (Keeling) Islands</option>
              <option value="CO">Colombia</option>
              <option value="KM">Comoros</option>
              <option value="CG">Congo</option>
              <option value="CD">Congo, Democratic Republic</option>
              <option value="CK">Cook Islands</option>
              <option value="CR">Costa Rica</option>
              <option value="CI">Cote D'Ivoire</option>
              <option value="HR">Croatia</option>
              <option value="CU">Cuba</option>
              <option value="CY">Cyprus</option>
              <option value="CZ">Czech Republic</option>
              <option value="DK">Denmark</option>
              <option value="DJ">Djibouti</option>
              <option value="DM">Dominica</option>
              <option value="DO">Dominican Republic</option>
              <option value="EC">Ecuador</option>
              <option value="EG">Egypt</option>
              <option value="SV">El Salvador</option>
              <option value="GQ">Equatorial Guinea</option>
              <option value="ER">Eritrea</option>
              <option value="EE">Estonia</option>
              <option value="ET">Ethiopia</option>
              <option value="FK">Falkland Islands (Malvinas)</option>
              <option value="FO">Faroe Islands</option>
              <option value="FJ">Fiji</option>
              <option value="FI">Finland</option>
              <option value="FR">France</option>
              <option value="GF">French Guiana</option>
              <option value="PF">French Polynesia</option>
              <option value="TF">French Southern Territories</option>
              <option value="GA">Gabon</option>
              <option value="GM">Gambia</option>
              <option value="GE">Georgia</option>
              <option value="DE">Germany</option>
              <option value="GH">Ghana</option>
              <option value="GI">Gibraltar</option>
              <option value="GR">Greece</option>
              <option value="GL">Greenland</option>
              <option value="GD">Grenada</option>
              <option value="GP">Guadeloupe</option>
              <option value="GU">Guam</option>
              <option value="GT">Guatemala</option>
              <option value="GN">Guinea</option>
              <option value="GW">Guinea-Bissau</option>
              <option value="GY">Guyana</option>
              <option value="HT">Haiti</option>
              <option value="HM">Heard Island & Mcdonald Islands</option>
              <option value="VA">Holy See (Vatican City State)</option>
              <option value="HN">Honduras</option>
              <option value="HK">Hong Kong</option>
              <option value="HU">Hungary</option>
              <option value="IS">Iceland</option>
              <option value="IN">India</option>
              <option value="ID">Indonesia</option>
              <option value="IR">Iran, Islamic Republic Of</option>
              <option value="IQ">Iraq</option>
              <option value="IE">Ireland</option>
              <option value="IL">Israel</option>
              <option value="IT">Italy</option>
              <option value="JM">Jamaica</option>
              <option value="JP">Japan</option>
              <option value="JO">Jordan</option>
              <option value="KZ">Kazakhstan</option>
              <option value="KE">Kenya</option>
              <option value="KI">Kiribati</option>
              <option value="KR">Korea</option>
              <option value="KW">Kuwait</option>
              <option value="KG">Kyrgyzstan</option>
              <option value="LA">Lao People's Democratic Republic</option>
              <option value="LV">Latvia</option>
              <option value="LB">Lebanon</option>
              <option value="LS">Lesotho</option>
              <option value="LR">Liberia</option>
              <option value="LY">Libyan Arab Jamahiriya</option>
              <option value="LI">Liechtenstein</option>
              <option value="LT">Lithuania</option>
              <option value="LU">Luxembourg</option>
              <option value="MO">Macao</option>
              <option value="MK">Macedonia</option>
              <option value="MG">Madagascar</option>
              <option value="MW">Malawi</option>
              <option value="MY">Malaysia</option>
              <option value="MV">Maldives</option>
              <option value="ML">Mali</option>
              <option value="MT">Malta</option>
              <option value="MH">Marshall Islands</option>
              <option value="MQ">Martinique</option>
              <option value="MR">Mauritania</option>
              <option value="MU">Mauritius</option>
              <option value="YT">Mayotte</option>
              <option value="MX">Mexico</option>
              <option value="FM">Micronesia, Federated States Of</option>
              <option value="MD">Moldova</option>
              <option value="MC">Monaco</option>
              <option value="MN">Mongolia</option>
              <option value="MS">Montserrat</option>
              <option value="MA">Morocco</option>
              <option value="MZ">Mozambique</option>
              <option value="MM">Myanmar</option>
              <option value="NA">Namibia</option>
              <option value="NR">Nauru</option>
              <option value="NP">Nepal</option>
              <option value="NL">Netherlands</option>
              <option value="AN">Netherlands Antilles</option>
              <option value="NC">New Caledonia</option>
              <option value="NZ">New Zealand</option>
              <option value="NI">Nicaragua</option>
              <option value="NE">Niger</option>
              <option value="NG">Nigeria</option>
              <option value="NU">Niue</option>
              <option value="NF">Norfolk Island</option>
              <option value="MP">Northern Mariana Islands</option>
              <option value="NO">Norway</option>
              <option value="OM">Oman</option>
              <option value="PK">Pakistan</option>
              <option value="PW">Palau</option>
              <option value="PS">Palestinian Territory, Occupied</option>
              <option value="PA">Panama</option>
              <option value="PG">Papua New Guinea</option>
              <option value="PY">Paraguay</option>
              <option value="PE">Peru</option>
              <option value="PH">Philippines</option>
              <option value="PN">Pitcairn</option>
              <option value="PL">Poland</option>
              <option value="PT">Portugal</option>
              <option value="PR">Puerto Rico</option>
              <option value="QA">Qatar</option>
              <option value="RE">Reunion</option>
              <option value="RO">Romania</option>
              <option value="RU">Russian Federation</option>
              <option value="RW">Rwanda</option>
              <option value="SH">Saint Helena</option>
              <option value="KN">Saint Kitts And Nevis</option>
              <option value="LC">Saint Lucia</option>
              <option value="PM">Saint Pierre And Miquelon</option>
              <option value="VC">Saint Vincent And Grenadines</option>
              <option value="WS">Samoa</option>
              <option value="SM">San Marino</option>
              <option value="ST">Sao Tome And Principe</option>
              <option value="SA">Saudi Arabia</option>
              <option value="SN">Senegal</option>
              <option value="CS">Serbia And Montenegro</option>
              <option value="SC">Seychelles</option>
              <option value="SL">Sierra Leone</option>
              <option value="SG">Singapore</option>
              <option value="SK">Slovakia</option>
              <option value="SI">Slovenia</option>
              <option value="SB">Solomon Islands</option>
              <option value="SO">Somalia</option>
              <option value="ZA">South Africa</option>
              <option value="GS">South Georgia And Sandwich Isl.</option>
              <option value="ES">Spain</option>
              <option value="LK">Sri Lanka</option>
              <option value="SD">Sudan</option>
              <option value="SR">Suriname</option>
              <option value="SJ">Svalbard And Jan Mayen</option>
              <option value="SZ">Swaziland</option>
              <option value="SE">Sweden</option>
              <option value="CH">Switzerland</option>
              <option value="SY">Syrian Arab Republic</option>
              <option value="TW">Taiwan</option>
              <option value="TJ">Tajikistan</option>
              <option value="TZ">Tanzania</option>
              <option value="TH">Thailand</option>
              <option value="TL">Timor-Leste</option>
              <option value="TG">Togo</option>
              <option value="TK">Tokelau</option>
              <option value="TO">Tonga</option>
              <option value="TT">Trinidad And Tobago</option>
              <option value="TN">Tunisia</option>
              <option value="TR">Turkey</option>
              <option value="TM">Turkmenistan</option>
              <option value="TC">Turks And Caicos Islands</option>
              <option value="TV">Tuvalu</option>
              <option value="UG">Uganda</option>
              <option value="UA">Ukraine</option>
              <option value="AE">United Arab Emirates</option>
              <option value="GB">United Kingdom</option>
              <option value="US">United States</option>
              <option value="UM">United States Outlying Islands</option>
              <option value="UY">Uruguay</option>
              <option value="UZ">Uzbekistan</option>
              <option value="VU">Vanuatu</option>
              <option value="VE">Venezuela</option>
              <option value="VN">Viet Nam</option>
              <option value="VG">Virgin Islands, British</option>
              <option value="VI">Virgin Islands, U.S.</option>
              <option value="WF">Wallis And Futuna</option>
              <option value="EH">Western Sahara</option>
              <option value="YE">Yemen</option>
              <option value="ZM">Zambia</option>
              <option value="ZW">Zimbabwe</option>
            </select>
          </div>
          <div>
            <label for="contactEmail">Email Address <span class="required">*</span></label>
            <input id="contactEmail" type="email" placeholder="your.email@example.com" required>
          </div>
        </div>

        <div class="form-grid">
          <div>
            <label for="dateOfBirth">Date of Birth <span class="required">*</span></label>
            <input id="dateOfBirth" type="date" required>
          </div>
          <div>
            <label for="phoneNumber">Phone Number <span class="required">*</span></label>
            <input id="phoneNumber" type="tel" placeholder="+971 50 123 4567" required>
          </div>
        </div>
      </div>

      <!-- Step 2: Flight Experience -->
      <div class="form-step" data-step="2">
        <h2 class="step-title">‚úàÔ∏è Flight Experience by Aircraft Type</h2>
        <p class="step-subtitle">Add your flight experience for each aircraft type you've flown. Click "Add Aircraft Type" to add multiple aircraft.</p>
        
        <div id="sections"></div>
        
        <div class="controls no-print">
          <button type="button" class="btn" id="btnAddSection">+ Add Aircraft Type</button>
        </div>

        <!-- Grand totals for all aircraft types -->
        <div class="section" id="grandTotals">
          <div class="section-title">
            <h3>GRAND TOTALS (All Aircraft Types)</h3>
          </div>
          <div class="grand">
            <div class="kpi">Combined Block Hours: <b id="gtCombined">0:00</b></div>
            <div class="kpi">Multi‚ÄëPilot Block Hours: <b id="gtMP">0:00</b></div>
            <div class="kpi">Night Hours: <b id="gtNight">0:00</b></div>
          </div>
        </div>

        <!-- SUMMARY SECTION -->
        <div class="summary">
          <h2 class="section-h">FLYING EXPERIENCE SUMMARY</h2>
          <h3 class="section-h" style="margin-top:6px">GENERAL</h3>
          <div class="section">
            <table>
              <thead>
                <tr>
                  <th><b>PIC/P1</b></th>
                  <th><b>SIC/P2</b></th>
                  <th><b>SOLO</b></th>
                  <th><b>INSTRUMENT</b></th>
                  <th><b>SIM</b></th>
                  <th><b>NIGHT</b></th>
                  <th><b>INSTRUCTOR</b></th>
                  <th><b>P1 U/S</b></th>
                  <th><b>GRAND TOTAL</b></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><input type="text" class="hhmm" placeholder="0:00"></td>
                  <td><input type="text" class="hhmm" placeholder="0:00"></td>
                  <td><input type="text" class="hhmm" placeholder="0:00"></td>
                  <td><input type="text" class="hhmm" placeholder="0:00"></td>
                  <td><input type="text" class="hhmm" placeholder="0:00"></td>
                  <td><input type="text" class="hhmm" placeholder="0:00"></td>
                  <td><input type="text" class="hhmm" placeholder="0:00"></td>
                  <td><input type="text" class="hhmm" placeholder="0:00"></td>
                  <td style="background: linear-gradient(135deg, #e0f2fe 0%, #b3e5fc 100%); font-weight: bold;"><b id="grandTotalHours">0:00</b></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Step 3: Documentation -->
      <div class="form-step" data-step="3">
        <h2 class="step-title">üìã Documentation</h2>
        <p class="step-subtitle">Upload your required documents. All documents should be clear, legible, and in PDF format.</p>
        
        <div class="form-section">
          <div class="section-title">Required Documents</div>
          
          <div style="margin-bottom: 24px;">
            <label>Pilot License <span class="required">*</span></label>
            <div class="upload-area" onclick="document.getElementById('licenseFile').click()">
              <div class="upload-icon">üìÑ</div>
              <p><strong>Click to upload</strong> or drag and drop your pilot license</p>
              <p style="font-size: 12px; color: var(--muted);">PDF, max 10MB</p>
            </div>
            <input type="file" id="licenseFile" style="display: none;" accept=".pdf" onchange="handleFileUpload(this, 'license')">
            <div id="licenseFileList" class="file-list"></div>
          </div>

          <div style="margin-bottom: 24px;">
            <label>Medical Certificate <span class="required">*</span></label>
            <div class="upload-area" onclick="document.getElementById('medicalFile').click()">
              <div class="upload-icon">üè•</div>
              <p><strong>Click to upload</strong> or drag and drop your medical certificate</p>
              <p style="font-size: 12px; color: var(--muted);">PDF, max 10MB</p>
            </div>
            <input type="file" id="medicalFile" style="display: none;" accept=".pdf" onchange="handleFileUpload(this, 'medical')">
            <div id="medicalFileList" class="file-list"></div>
          </div>

          <div style="margin-bottom: 24px;">
            <label>Logbook Pages</label>
            <div class="upload-area" onclick="document.getElementById('logbookFile').click()">
              <div class="upload-icon">üìä</div>
              <p><strong>Click to upload</strong> or drag and drop recent logbook pages</p>
              <p style="font-size: 12px; color: var(--muted);">PDF, max 10MB</p>
            </div>
            <input type="file" id="logbookFile" style="display: none;" accept=".pdf" onchange="handleFileUpload(this, 'logbook')">
            <div id="logbookFileList" class="file-list"></div>
          </div>

          <div style="margin-bottom: 24px;">
            <label>Resume/CV</label>
            <div class="upload-area" onclick="document.getElementById('resumeFile').click()">
              <div class="upload-icon">üìù</div>
              <p><strong>Click to upload</strong> or drag and drop your resume</p>
              <p style="font-size: 12px; color: var(--muted);">PDF, max 10MB</p>
            </div>
            <input type="file" id="resumeFile" style="display: none;" accept=".pdf" onchange="handleFileUpload(this, 'resume')">
            <div id="resumeFileList" class="file-list"></div>
          </div>
        </div>
      </div>

      <!-- Step 4: Review & Submit -->
      <div class="form-step" data-step="4">
        <h2 class="step-title">üîç Review & Submit</h2>
        <p class="step-subtitle">Please review all your information before submitting your application.</p>
        
        <div class="form-section">
          <div class="section-title">Application Summary</div>
          <div id="applicationSummary">
            <!-- Summary will be populated by JavaScript -->
          </div>
        </div>

        <div class="form-section">
          <div class="section-title">Declaration</div>
          <label style="display: flex; align-items: flex-start; gap: 12px; margin-bottom: 16px;">
            <input type="checkbox" id="declaration" required style="width: auto; margin-top: 4px;">
            <span>I declare that all information provided in this application is true and accurate to the best of my knowledge. I understand that any false or misleading information may result in the rejection of my application or termination of employment.</span>
          </label>
        </div>
      </div>

      <!-- Navigation -->
      <div class="form-navigation">
        <div class="nav-left">
          <div class="auto-save-status" id="autoSaveStatus">
            <span class="spinner" style="display: none;"></span>
            <span class="status-text">Ready</span>
          </div>
        </div>
        <div class="nav-right">
          <button class="btn" id="prevBtn" onclick="previousStep()" style="display: none;">Previous</button>
          <button class="btn primary" id="nextBtn" onclick="nextStep()">Next Step</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== Multi-Step Form System =====
    let currentStep = 1;
    const totalSteps = 4;
    let formData = {};
    let sessionId = generateSessionId();
    let autoSaveTimer;

    // Generate unique session ID
    function generateSessionId() {
      return 'pilot_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }

    // Initialize form system
    function initializeForm() {
      loadFormData();
      checkForRecovery();
      updateProgress();
      setupAutoSave();
      setupEventListeners();
    }

    // Check for previous session
    function checkForRecovery() {
      const savedData = localStorage.getItem('pilotFormData');
      if (savedData) {
        const data = JSON.parse(savedData);
        if (data.sessionId && Date.now() - data.lastSaved < 7 * 24 * 60 * 60 * 1000) { // 7 days
          document.getElementById('recoveryBanner').classList.add('show');
        }
      }
    }

    // Recover previous session
    function recoverSession() {
      const savedData = localStorage.getItem('pilotFormData');
      if (savedData) {
        const data = JSON.parse(savedData);
        formData = data.formData || {};
        currentStep = 1;
        sessionId = data.sessionId || generateSessionId();
        
        populateFormFields();
        showStep(currentStep);
        document.getElementById('recoveryBanner').classList.remove('show');
        showAutoSaveStatus('Restored previous session', 'saved');
      }
    }

    // Clear session and start fresh
    function clearSession() {
      localStorage.removeItem('pilotFormData');
      formData = {};
      currentStep = 1;
      sessionId = generateSessionId();
      showStep(1);
      document.getElementById('recoveryBanner').classList.remove('show');
      showAutoSaveStatus('Starting fresh session', 'saved');
    }

    // Setup auto-save functionality
    function setupAutoSave() {
      // Auto-save every 30 seconds
      setInterval(() => {
        if (hasFormChanges()) {
          saveFormData();
        }
      }, 30000);
    }

    // Setup event listeners
    function setupEventListeners() {
      // Add change listeners to all form inputs
      document.addEventListener('input', (e) => {
        if (e.target.matches('input, select, textarea')) {
          // Trigger auto-save after 2 seconds of no typing
          clearTimeout(autoSaveTimer);
          showAutoSaveStatus('Typing...', 'saving');
          
          autoSaveTimer = setTimeout(() => {
            collectFormData();
            saveFormData();
          }, 2000);
        }
      });
    }

    // Collect current form data
    function collectFormData() {
      // Step 1: Personal Information
      if (currentStep >= 1) {
        formData.personalInfo = {
          pilotName: document.getElementById('pilotName')?.value || '',
          designation: document.getElementById('designation')?.value || '',
          doj: document.getElementById('doj')?.value || '',
          nationality: document.getElementById('nationality')?.value || '',
          contactEmail: document.getElementById('contactEmail')?.value || '',
          dateOfBirth: document.getElementById('dateOfBirth')?.value || '',
          phoneNumber: document.getElementById('phoneNumber')?.value || ''
        };
      }
      
      // Step 2: Flight Experience
      if (currentStep >= 2) {
        const aircraftSections = [];
        document.querySelectorAll('#sections .form-section').forEach(section => {
          const aircraftType = section.querySelector('.ac-type')?.value || '';
          const notes = section.querySelector('.ac-notes')?.value || '';
          const inputs = section.querySelectorAll('.hhmm');
          
          const flightHours = {
            pic: inputs[0]?.value || '0:00',
            sic: inputs[1]?.value || '0:00',
            solo: inputs[2]?.value || '0:00',
            instrument: inputs[3]?.value || '0:00',
            sim: inputs[4]?.value || '0:00',
            night: inputs[5]?.value || '0:00',
            instructor: inputs[6]?.value || '0:00',
            p1us: inputs[7]?.value || '0:00'
          };
          
          aircraftSections.push({
            aircraftType,
            notes,
            flightHours
          });
        });
        
        // Collect summary flight hours
        const summaryInputs = document.querySelectorAll('#grandTotalHours').closest('tr').querySelectorAll('.hhmm');
        const summaryHours = {
          pic: summaryInputs[0]?.value || '0:00',
          sic: summaryInputs[1]?.value || '0:00',
          solo: summaryInputs[2]?.value || '0:00',
          instrument: summaryInputs[3]?.value || '0:00',
          sim: summaryInputs[4]?.value || '0:00',
          night: summaryInputs[5]?.value || '0:00',
          instructor: summaryInputs[6]?.value || '0:00',
          p1us: summaryInputs[7]?.value || '0:00'
        };
        
        formData.flightExperience = {
          aircraftSections,
          summaryHours,
          grandTotals: {
            combined: document.getElementById('gtCombined')?.textContent || '0:00',
            multiPilot: document.getElementById('gtMP')?.textContent || '0:00',
            night: document.getElementById('gtNight')?.textContent || '0:00'
          }
        };
      }
      
      // Step 3: Documentation
      if (currentStep >= 3) {
        formData.documentation = {
          licenseFile: document.getElementById('licenseFile')?.files[0]?.name || '',
          medicalFile: document.getElementById('medicalFile')?.files[0]?.name || '',
          logbookFile: document.getElementById('logbookFile')?.files[0]?.name || '',
          resumeFile: document.getElementById('resumeFile')?.files[0]?.name || ''
        };
      }
      
      // Step 4: Review & Submit
      if (currentStep >= 4) {
        formData.declaration = {
          agreed: document.getElementById('declaration')?.checked || false
        };
      }
    }

    // Save form data to localStorage
    function saveFormData() {
      const saveData = {
        sessionId: sessionId,
        currentStep: currentStep,
        formData: formData,
        lastSaved: Date.now(),
        expiresAt: Date.now() + (30 * 24 * 60 * 60 * 1000) // 30 days
      };
      
      localStorage.setItem('pilotFormData', JSON.stringify(saveData));
      showAutoSaveStatus('All changes saved', 'saved');
    }

    // Load form data from localStorage
    function loadFormData() {
      const savedData = localStorage.getItem('pilotFormData');
      if (savedData) {
        const data = JSON.parse(savedData);
        
        // Check if data hasn't expired
        if (Date.now() < data.expiresAt) {
          formData = data.formData || {};
          return true;
        } else {
          // Clear expired data
          localStorage.removeItem('pilotFormData');
        }
      }
      return false;
    }

    // Populate form fields with saved data
    function populateFormFields() {
      if (formData.personalInfo) {
        const info = formData.personalInfo;
        document.getElementById('pilotName').value = info.pilotName || '';
        document.getElementById('nationality').value = info.nationality || '';
        document.getElementById('contactEmail').value = info.contactEmail || '';
        document.getElementById('dateOfBirth').value = info.dateOfBirth || '';
        document.getElementById('phoneNumber').value = info.phoneNumber || '';
        document.getElementById('designation').value = info.designation || '';
        document.getElementById('expectedDateOfJoining').value = info.expectedDateOfJoining || '';
        document.getElementById('previousEmployer').value = info.previousEmployer || '';
      }
      
      if (formData.flightExperience) {
        const exp = formData.flightExperience;
        document.getElementById('pilotLicense').value = exp.pilotLicense || '';
        document.getElementById('licenseNumber').value = exp.licenseNumber || '';
        document.getElementById('licenseAuthority').value = exp.licenseAuthority || '';
        document.getElementById('totalFlightHours').value = exp.totalFlightHours || '';
        document.getElementById('picHours').value = exp.picHours || '';
        document.getElementById('instrumentHours').value = exp.instrumentHours || '';
        document.getElementById('aircraftTypes').value = exp.aircraftTypes || '';
        document.getElementById('turbineHours').value = exp.turbineHours || '';
        document.getElementById('jetHours').value = exp.jetHours || '';
      }
      
      if (formData.declaration) {
        document.getElementById('declaration').checked = formData.declaration.agreed || false;
      }
    }

    // Check if form has unsaved changes
    function hasFormChanges() {
      const currentData = { ...formData };
      collectFormData();
      return JSON.stringify(currentData) !== JSON.stringify(formData);
    }

    // Show auto-save status
    function showAutoSaveStatus(message, type) {
      const statusEl = document.getElementById('autoSaveStatus');
      const spinner = statusEl.querySelector('.spinner');
      const text = statusEl.querySelector('.status-text');
      
      statusEl.className = `auto-save-status ${type}`;
      text.textContent = message;
      
      if (type === 'saving') {
        spinner.style.display = 'inline-block';
      } else {
        spinner.style.display = 'none';
      }
      
      // Clear status after 3 seconds
      setTimeout(() => {
        if (statusEl.classList.contains(type)) {
          statusEl.className = 'auto-save-status';
          text.textContent = 'Ready';
          spinner.style.display = 'none';
        }
      }, 3000);
    }

    // Navigate to next step
    function nextStep() {
      if (validateCurrentStep()) {
        collectFormData();
        saveFormData();
        
        if (currentStep < totalSteps) {
          currentStep++;
          showStep(currentStep);
        }
      }
    }

    // Navigate to previous step  
    function previousStep() {
      collectFormData();
      saveFormData();
      
      if (currentStep > 1) {
        currentStep--;
        showStep(currentStep);
      }
    }

    // Show specific step
    function showStep(step) {
      // Hide all steps
      document.querySelectorAll('.form-step').forEach(stepEl => {
        stepEl.classList.remove('active');
      });
      
      // Show current step
      const currentStepEl = document.querySelector(`.form-step[data-step="${step}"]`);
      if (currentStepEl) {
        currentStepEl.classList.add('active');
      }
      
      // Generate summary if showing review step
      if (step === 4) {
        collectFormData();
        generateApplicationSummary();
      }
      
      updateProgress();
      updateNavigation();
    }

    // Update progress bar and steps
    function updateProgress() {
      const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
      document.getElementById('progressFill').style.width = `${progress}%`;
      
      // Update step indicators
      document.querySelectorAll('.step').forEach((stepEl, index) => {
        const stepNumber = index + 1;
        stepEl.classList.remove('active', 'completed');
        
        if (stepNumber < currentStep) {
          stepEl.classList.add('completed');
        } else if (stepNumber === currentStep) {
          stepEl.classList.add('active');
        }
      });
    }

    // Update navigation buttons
    function updateNavigation() {
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      
      prevBtn.style.display = currentStep > 1 ? 'inline-flex' : 'none';
      nextBtn.textContent = currentStep === totalSteps ? 'Submit Application' : 'Next Step';
    }

    // Validate current step
    function validateCurrentStep() {
      if (currentStep === 1) {
        return validatePersonalInfo();
      } else if (currentStep === 2) {
        return validateFlightExperience();
      } else if (currentStep === 3) {
        return validateDocumentation();
      } else if (currentStep === 4) {
        return validateDeclaration();
      }
      return true;
    }

    // Validate personal information
    function validatePersonalInfo() {
      const requiredFields = ['pilotName', 'designation', 'doj', 'nationality', 'contactEmail', 'dateOfBirth', 'phoneNumber'];
      let isValid = true;
      
      requiredFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (!field.value.trim()) {
          field.style.borderColor = '#dc2626';
          isValid = false;
          
          // Reset border color on input
          field.addEventListener('input', () => {
            field.style.borderColor = '#e2e8f0';
          }, { once: true });
        }
      });
      
      if (!isValid) {
        alert('Please fill in all required fields before continuing.');
      }
      
      return isValid;
    }

    // Validate flight experience
    function validateFlightExperience() {
      // Check if at least one aircraft section has data
      const sections = document.querySelectorAll('#sections .form-section');
      let hasData = false;
      
      sections.forEach(section => {
        const aircraftType = section.querySelector('.ac-type')?.value;
        const inputs = section.querySelectorAll('.hhmm');
        
        if (aircraftType) {
          hasData = true;
        }
        
        // Check if "Other" is selected but no notes provided
        if (aircraftType === 'Other - Specify in Notes') {
          const notes = section.querySelector('.ac-notes')?.value;
          if (!notes || !notes.trim()) {
            alert('Please specify the aircraft type in the notes field when "Other" is selected.');
            return false;
          }
        }
      });
      
      if (!hasData) {
        alert('Please add at least one aircraft type and select it from the dropdown before continuing.');
        return false;
      }
      
      return true;
    }

    // Validate documentation
    function validateDocumentation() {
      const requiredFiles = ['licenseFile', 'medicalFile'];
      let isValid = true;
      
      requiredFiles.forEach(fileId => {
        const fileInput = document.getElementById(fileId);
        if (!fileInput.files || fileInput.files.length === 0) {
          const uploadArea = fileInput.parentElement.querySelector('.upload-area');
          uploadArea.style.borderColor = '#dc2626';
          isValid = false;
          
          fileInput.addEventListener('change', () => {
            uploadArea.style.borderColor = '#e2e8f0';
          }, { once: true });
        }
      });
      
      if (!isValid) {
        alert('Please upload all required documents before continuing.');
      }
      
      return isValid;
    }

    // Validate declaration
    function validateDeclaration() {
      const declaration = document.getElementById('declaration');
      if (!declaration.checked) {
        alert('Please accept the declaration before submitting your application.');
        return false;
      }
      return true;
    }

    // Handle file upload
    function handleFileUpload(input, type) {
      const file = input.files[0];
      if (!file) return;
      
      // Validate file type
      if (file.type !== 'application/pdf') {
        alert('Please upload only PDF files.');
        input.value = '';
        return;
      }
      
      // Validate file size (10MB limit)
      if (file.size > 10 * 1024 * 1024) {
        alert('File size must be less than 10MB.');
        input.value = '';
        return;
      }
      
      // Show file in the list
      const fileListId = type + 'FileList';
      const fileList = document.getElementById(fileListId);
      
      fileList.innerHTML = `
        <div class="file-item">
          <div class="file-info">
            <div class="file-icon">üìÑ</div>
            <div class="file-details">
              <div class="file-name">${file.name}</div>
              <div class="file-size">${(file.size / 1024 / 1024).toFixed(1)} MB</div>
            </div>
          </div>
          <div class="file-status completed">‚úì Ready</div>
        </div>
      `;
      
      // Reset upload area border
      const uploadArea = input.parentElement.querySelector('.upload-area');
      uploadArea.style.borderColor = '#e2e8f0';
    }

    // Generate application summary for review step
    function generateApplicationSummary() {
      if (currentStep !== 4) return;
      
      const summaryEl = document.getElementById('applicationSummary');
      let html = '';
      
      if (formData.personalInfo) {
        html += `
          <div style="margin-bottom: 24px; padding: 20px; background: #f8fafc; border-radius: 12px;">
            <h3 style="color: var(--flydubai-navy); margin-bottom: 12px;">Personal Information</h3>
            <div style="display: grid; gap: 8px; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
              <div><strong>Name:</strong> ${formData.personalInfo.pilotName}</div>
              <div><strong>Nationality:</strong> ${formData.personalInfo.nationality}</div>
              <div><strong>Email:</strong> ${formData.personalInfo.contactEmail}</div>
              <div><strong>Date of Birth:</strong> ${formData.personalInfo.dateOfBirth}</div>
              <div><strong>Phone:</strong> ${formData.personalInfo.phoneNumber}</div>
              <div><strong>Designation:</strong> ${formData.personalInfo.designation}</div>
              ${formData.personalInfo.expectedDateOfJoining ? `<div><strong>Expected Joining:</strong> ${formData.personalInfo.expectedDateOfJoining}</div>` : ''}
              ${formData.personalInfo.previousEmployer ? `<div><strong>Previous Employer:</strong> ${formData.personalInfo.previousEmployer}</div>` : ''}
            </div>
          </div>
        `;
      }
      
      if (formData.flightExperience) {
        html += `
          <div style="margin-bottom: 24px; padding: 20px; background: #f8fafc; border-radius: 12px;">
            <h3 style="color: var(--flydubai-navy); margin-bottom: 12px;">Flight Experience</h3>
            <div style="display: grid; gap: 8px; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
              <div><strong>License Type:</strong> ${formData.flightExperience.pilotLicense}</div>
              <div><strong>License Number:</strong> ${formData.flightExperience.licenseNumber}</div>
              <div><strong>License Authority:</strong> ${formData.flightExperience.licenseAuthority}</div>
              <div><strong>Total Flight Hours:</strong> ${formData.flightExperience.totalFlightHours}</div>
              ${formData.flightExperience.picHours ? `<div><strong>PIC Hours:</strong> ${formData.flightExperience.picHours}</div>` : ''}
              ${formData.flightExperience.instrumentHours ? `<div><strong>Instrument Hours:</strong> ${formData.flightExperience.instrumentHours}</div>` : ''}
              ${formData.flightExperience.turbineHours ? `<div><strong>Turbine Hours:</strong> ${formData.flightExperience.turbineHours}</div>` : ''}
              ${formData.flightExperience.jetHours ? `<div><strong>Jet Hours:</strong> ${formData.flightExperience.jetHours}</div>` : ''}
            </div>
            ${formData.flightExperience.aircraftTypes ? `<div style="margin-top: 12px;"><strong>Aircraft Types:</strong><br>${formData.flightExperience.aircraftTypes}</div>` : ''}
          </div>
        `;
      }
      
      summaryEl.innerHTML = html;
    }

    // Original form JavaScript for aircraft sections and calculations
    let sectionCount = 0;

    // Function to check if aircraft is above 50 tons MTOW
    function isHeavyJet(aircraftType) {
      const heavyJets = [
        // Boeing 737 variants (all above 50T MTOW)
        'Boeing 737 NG/MAX',
        'Boeing 737 Classic (300-500)',
        // Boeing Commercial Aircraft
        'Boeing 757-200', 'Boeing 757-300',
        'Boeing 767-200', 'Boeing 767-300', 
        'Boeing 777-200', 'Boeing 777-300',
        'Boeing 787-8 Dreamliner', 'Boeing 787-9 Dreamliner', 'Boeing 787-10 Dreamliner',
        // Airbus Commercial Aircraft  
        'Airbus A319', 'Airbus A320', 'Airbus A321',
        'Airbus A330-200', 'Airbus A330-300',
        'Airbus A340-200', 'Airbus A340-300',
        'Airbus A350-900', 'Airbus A350-1000',
        'Airbus A380',
        // Regional Jets above 50T
        'McDonnell Douglas MD-80', 'McDonnell Douglas MD-90',
        'Embraer E-Jet E190', 'Embraer E-Jet E195',
        'British Aerospace BAe 146', 'Avro RJ70', 'Avro RJ85', 'Avro RJ100',
        // Business Jets above 50T
        'Gulfstream G550', 'Gulfstream G600', 'Gulfstream G650', 'Gulfstream G700',
        'Bombardier Global 5000', 'Bombardier Global 5500', 'Bombardier Global 6000', 
        'Bombardier Global 6500', 'Bombardier Global 7500',
        'Dassault Falcon 2000', 'Dassault Falcon 2000EX', 'Dassault Falcon 2000LX',
        'Dassault Falcon 7X', 'Dassault Falcon 8X', 'Dassault Falcon 900',
        'Cessna Citation Longitude', 'Embraer Lineage 1000',
        // Cargo Aircraft
        'Boeing 747-400F Freighter', 'Boeing 767-300F Freighter',
        'Boeing 777F Freighter', 'Airbus A330-200F Freighter',
        'McDonnell Douglas MD-11F',
        // Military & Special Aircraft above 50T
        'Lockheed C-130 Hercules', 'Boeing KC-135 Stratotanker', 'Airbus A400M Atlas',
        'Boeing E-3 AWACS', 'Lockheed P-3 Orion', 'Boeing P-8 Poseidon',
        // Vintage & Classic Aircraft above 50T
        'Douglas DC-3', 'Boeing 727', 'McDonnell Douglas DC-9',
        'Lockheed L-1011 TriStar', 'Sud Aviation Caravelle', 'BAC One-Eleven',
        'Fokker F28', 'Fokker 100'
      ];
      return heavyJets.includes(aircraftType);
    }

    // Add aircraft section functionality
    function addAircraftSection(b737Type = null, locked = false) {
      sectionCount++;
      const sec = document.createElement('section');
      sec.className = 'section';
      sec.setAttribute('data-section-id', sectionCount);
      sec.dataset.locked = locked ? '1' : '0';
      
      const label = `Aircraft Type ${sectionCount}`;
      const typeText = b737Type ? (b737Type === 'ng-max' ? 'Boeing 737 NG/MAX' : 'Boeing 737 Classic (300-500)') : '';
      
      let aircraftDropdown;
      if(b737Type) {
        aircraftDropdown = `
        <div style="display: grid; grid-template-columns: 400px auto 1fr; gap: 16px; align-items: end;">
          <div>
            <select class="ac-type" ${locked ? 'disabled' : ''} style="width: 100%; padding: 14px 16px; border-radius: 12px; border: 3px solid #cbd5e1; background: #ffffff; color: var(--ink); font-size: 14px; font-weight: 500; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), inset 0 1px 3px rgba(0, 0, 0, 0.05); ${locked ? 'background-color: #f3f4f6; cursor: not-allowed;' : ''}">
              ${b737Type === 'ng-max' ? `
                <option value="Boeing 737 NG/MAX">Boeing 737 NG/MAX</option>
              ` : `
                <option value="Boeing 737 Classic (300-500)">Boeing 737 Classic (300-500)</option>
              `}
            </select>
          </div>
          <div class="heavy-jet-indicator" style="display: flex; align-items: center; background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; padding: 8px 12px; border-radius: 8px; font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; box-shadow: 0 2px 4px rgba(5, 150, 105, 0.3);">
            ‚úà >50T MTOW
          </div>
          <div class="notes-field" style="display: none;">
            <label>Notes/Comments (Required if "Other" selected above)</label>
            <input type="text" class="ac-notes" placeholder="Please specify aircraft type, model, or any additional details..." style="width: 100%; padding: 14px 16px; border-radius: 12px; border: 2px solid var(--line); background: #ffffff; color: var(--ink); font-family: inherit; font-size: 14px;" />
          </div>
        </div>`;
      } else {
        aircraftDropdown = `
        <div style="display: grid; grid-template-columns: 400px auto 1fr; gap: 16px; align-items: end;">
          <div>
            <select class="ac-type" style="width: 100%; padding: 14px 16px; border-radius: 12px; border: 3px solid #cbd5e1; background: #ffffff; color: var(--ink); font-size: 14px; font-weight: 500; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), inset 0 1px 3px rgba(0, 0, 0, 0.05);">
              <option value="">Select Aircraft Type...</option>
              <optgroup label="Boeing Commercial Aircraft">
                <option value="Boeing 757-200">Boeing 757-200</option>
                <option value="Boeing 757-300">Boeing 757-300</option>
                <option value="Boeing 767-200">Boeing 767-200</option>
                <option value="Boeing 767-300">Boeing 767-300</option>
                <option value="Boeing 777-200">Boeing 777-200</option>
                <option value="Boeing 777-300">Boeing 777-300</option>
                <option value="Boeing 787-8">Boeing 787-8 Dreamliner</option>
                <option value="Boeing 787-9">Boeing 787-9 Dreamliner</option>
                <option value="Boeing 787-10">Boeing 787-10 Dreamliner</option>
              </optgroup>
              <optgroup label="Airbus Commercial Aircraft">
                <option value="Airbus A319">Airbus A319</option>
                <option value="Airbus A320">Airbus A320</option>
                <option value="Airbus A321">Airbus A321</option>
                <option value="Airbus A330-200">Airbus A330-200</option>
                <option value="Airbus A330-300">Airbus A330-300</option>
                <option value="Airbus A340-200">Airbus A340-200</option>
                <option value="Airbus A340-300">Airbus A340-300</option>
                <option value="Airbus A350-900">Airbus A350-900</option>
                <option value="Airbus A350-1000">Airbus A350-1000</option>
                <option value="Airbus A380">Airbus A380</option>
              </optgroup>
              <optgroup label="Regional Jets & Commercial Aircraft">
                <option value="McDonnell Douglas MD-80">McDonnell Douglas MD-80</option>
                <option value="McDonnell Douglas MD-90">McDonnell Douglas MD-90</option>
                <option value="Embraer E-Jet E170">Embraer E-Jet E170</option>
                <option value="Embraer E-Jet E175">Embraer E-Jet E175</option>
                <option value="Embraer E-Jet E190">Embraer E-Jet E190</option>
                <option value="Embraer E-Jet E195">Embraer E-Jet E195</option>
                <option value="Bombardier CRJ-100">Bombardier CRJ-100</option>
                <option value="Bombardier CRJ-200">Bombardier CRJ-200</option>
                <option value="Bombardier CRJ-700">Bombardier CRJ-700</option>
                <option value="Bombardier CRJ-900">Bombardier CRJ-900</option>
                <option value="Bombardier CRJ-1000">Bombardier CRJ-1000</option>
                <option value="British Aerospace 146">British Aerospace BAe 146</option>
                <option value="Avro RJ70">Avro RJ70</option>
                <option value="Avro RJ85">Avro RJ85</option>
                <option value="Avro RJ100">Avro RJ100</option>
                <option value="Dornier 328JET">Dornier 328JET</option>
                <option value="Fairchild Metro III">Fairchild Metro III</option>
                <option value="Jetstream 41">BAe Jetstream 41</option>
                <option value="Embraer EMB-120">Embraer EMB-120 Brasilia</option>
              </optgroup>
              <optgroup label="Cargo Aircraft">
                <option value="Boeing 747-400F">Boeing 747-400F Freighter</option>
                <option value="Boeing 767-300F">Boeing 767-300F Freighter</option>
                <option value="Boeing 777F">Boeing 777F Freighter</option>
                <option value="Airbus A330-200F">Airbus A330-200F Freighter</option>
                <option value="McDonnell Douglas MD-11F">McDonnell Douglas MD-11F</option>
              </optgroup>
              <optgroup label="Business Jets & Private Aircraft">
                <option value="Gulfstream G150">Gulfstream G150</option>
                <option value="Gulfstream G280">Gulfstream G280</option>
                <option value="Gulfstream G450">Gulfstream G450</option>
                <option value="Gulfstream G500">Gulfstream G500</option>
                <option value="Gulfstream G550">Gulfstream G550</option>
                <option value="Gulfstream G600">Gulfstream G600</option>
                <option value="Gulfstream G650">Gulfstream G650</option>
                <option value="Gulfstream G700">Gulfstream G700</option>
                <option value="Bombardier Global 5000">Bombardier Global 5000</option>
                <option value="Bombardier Global 5500">Bombardier Global 5500</option>
                <option value="Bombardier Global 6000">Bombardier Global 6000</option>
                <option value="Bombardier Global 6500">Bombardier Global 6500</option>
                <option value="Bombardier Global 7500">Bombardier Global 7500</option>
                <option value="Bombardier Challenger 300">Bombardier Challenger 300</option>
                <option value="Bombardier Challenger 350">Bombardier Challenger 350</option>
                <option value="Bombardier Challenger 605">Bombardier Challenger 605</option>
                <option value="Bombardier Challenger 650">Bombardier Challenger 650</option>
                <option value="Dassault Falcon 2000">Dassault Falcon 2000</option>
                <option value="Dassault Falcon 2000EX">Dassault Falcon 2000EX</option>
                <option value="Dassault Falcon 2000LX">Dassault Falcon 2000LX</option>
                <option value="Dassault Falcon 6X">Dassault Falcon 6X</option>
                <option value="Dassault Falcon 7X">Dassault Falcon 7X</option>
                <option value="Dassault Falcon 8X">Dassault Falcon 8X</option>
                <option value="Dassault Falcon 900">Dassault Falcon 900</option>
                <option value="Cessna Citation X">Cessna Citation X</option>
                <option value="Cessna Citation X+">Cessna Citation X+</option>
                <option value="Cessna Citation Columbus">Cessna Citation Columbus</option>
                <option value="Cessna Citation Hemisphere">Cessna Citation Hemisphere</option>
                <option value="Cessna Citation Sovereign">Cessna Citation Sovereign</option>
                <option value="Cessna Citation Sovereign+">Cessna Citation Sovereign+</option>
                <option value="Cessna Citation Latitude">Cessna Citation Latitude</option>
                <option value="Cessna Citation Longitude">Cessna Citation Longitude</option>
                <option value="Hawker 4000">Hawker 4000</option>
                <option value="Hawker 800XP">Hawker 800XP</option>
                <option value="Hawker 850XP">Hawker 850XP</option>
                <option value="Hawker 900XP">Hawker 900XP</option>
                <option value="Embraer Legacy 450">Embraer Legacy 450</option>
                <option value="Embraer Legacy 500">Embraer Legacy 500</option>
                <option value="Embraer Legacy 600">Embraer Legacy 600</option>
                <option value="Embraer Legacy 650">Embraer Legacy 650</option>
                <option value="Embraer Lineage 1000">Embraer Lineage 1000</option>
                <option value="Embraer Praetor 500">Embraer Praetor 500</option>
                <option value="Embraer Praetor 600">Embraer Praetor 600</option>
              </optgroup>
              <optgroup label="Light Jets & Mid-Size Jets">
                <option value="Cessna Citation CJ3+">Cessna Citation CJ3+</option>
                <option value="Cessna Citation CJ4">Cessna Citation CJ4</option>
                <option value="Cessna Citation M2">Cessna Citation M2</option>
                <option value="Cessna Citation XLS+">Cessna Citation XLS+</option>
                <option value="Embraer Phenom 100">Embraer Phenom 100</option>
                <option value="Embraer Phenom 300">Embraer Phenom 300</option>
                <option value="HondaJet">HondaJet</option>
                <option value="Pilatus PC-24">Pilatus PC-24</option>
                <option value="Beechcraft Premier 1A">Beechcraft Premier 1A</option>
                <option value="Learjet 45">Learjet 45</option>
                <option value="Learjet 60">Learjet 60</option>
                <option value="Learjet 70">Learjet 70</option>
                <option value="Learjet 75">Learjet 75</option>
              </optgroup>
              <optgroup label="Turboprop Aircraft">
                <option value="ATR 42">ATR 42</option>
                <option value="ATR 72">ATR 72</option>
                <option value="Bombardier Q400">Bombardier Q400 (Dash 8)</option>
                <option value="Bombardier Dash 8-100">Bombardier Dash 8-100</option>
                <option value="Bombardier Dash 8-200">Bombardier Dash 8-200</option>
                <option value="Bombardier Dash 8-300">Bombardier Dash 8-300</option>
                <option value="Saab 340">Saab 340</option>
                <option value="Saab 2000">Saab 2000</option>
                <option value="Dornier 328">Dornier Do 328</option>
                <option value="Let L-410">Let L-410 Turbolet</option>
                <option value="Jetstream 32">BAe Jetstream 32</option>
                <option value="Jetstream 31">BAe Jetstream 31</option>
                <option value="Beechcraft 1900">Beechcraft 1900</option>
                <option value="Beechcraft King Air 90">Beechcraft King Air 90</option>
                <option value="Beechcraft King Air 200">Beechcraft King Air 200</option>
                <option value="Beechcraft King Air 250">Beechcraft King Air 250</option>
                <option value="Beechcraft King Air 300">Beechcraft King Air 300</option>
                <option value="Beechcraft King Air 350">Beechcraft King Air 350</option>
                <option value="Pilatus PC-12">Pilatus PC-12</option>
                <option value="Pilatus PC-6 Porter">Pilatus PC-6 Porter</option>
                <option value="TBM 700">TBM 700</option>
                <option value="TBM 850">TBM 850</option>
                <option value="TBM 900">TBM 900</option>
                <option value="TBM 930">TBM 930</option>
                <option value="TBM 960">TBM 960</option>
                <option value="Piper Meridian">Piper Meridian</option>
                <option value="Piper Cheyenne">Piper Cheyenne</option>
                <option value="Cessna Caravan 208">Cessna Caravan 208</option>
                <option value="Cessna 208 Amphibian">Cessna 208 Caravan Amphibian</option>
                <option value="Cessna Conquest">Cessna Conquest</option>
                <option value="Cessna 441">Cessna 441 Conquest</option>
                <option value="Piper Aztec">Piper PA-23 Aztec</option>
                <option value="Britten-Norman Islander">Britten-Norman BN-2 Islander</option>
                <option value="Britten-Norman Trislander">Britten-Norman BN-2A Trislander</option>
                <option value="DHC-6 Twin Otter">de Havilland Canada DHC-6 Twin Otter</option>
                <option value="DHC-7 Dash 7">de Havilland Canada DHC-7 Dash 7</option>
                <option value="Shorts 330">Shorts 330</option>
                <option value="Shorts 360">Shorts 360</option>
              </optgroup>
              <optgroup label="Single Engine Piston">
                <option value="Cessna 150">Cessna 150</option>
                <option value="Cessna 152">Cessna 152</option>
                <option value="Cessna 162 SkyCatcher">Cessna 162 SkyCatcher</option>
                <option value="Cessna 172">Cessna 172 Skyhawk</option>
                <option value="Cessna 177">Cessna 177 Cardinal</option>
                <option value="Cessna 180">Cessna 180 Skywagon</option>
                <option value="Cessna 182">Cessna 182 Skylane</option>
                <option value="Cessna 185">Cessna 185 Skywagon</option>
                <option value="Cessna 206">Cessna 206 Stationair</option>
                <option value="Cessna 210">Cessna 210 Centurion</option>
                <option value="Piper Cherokee">Piper Cherokee (PA-28)</option>
                <option value="Piper Warrior">Piper Warrior (PA-28)</option>
                <option value="Piper Archer">Piper Archer (PA-28)</option>
                <option value="Piper Arrow">Piper Arrow (PA-28R)</option>
                <option value="Piper Saratoga">Piper Saratoga (PA-32)</option>
                <option value="Piper Lance">Piper Lance (PA-32R)</option>
                <option value="Piper Cub">Piper J-3 Cub</option>
                <option value="Piper Super Cub">Piper PA-18 Super Cub</option>
                <option value="Beechcraft Bonanza">Beechcraft Bonanza (A36)</option>
                <option value="Beechcraft Musketeer">Beechcraft Musketeer</option>
                <option value="Beechcraft Sundowner">Beechcraft Sundowner</option>
                <option value="Cirrus SR20">Cirrus SR20</option>
                <option value="Cirrus SR22">Cirrus SR22</option>
                <option value="Diamond DA20">Diamond DA20 Katana</option>
                <option value="Diamond DA40">Diamond DA40 Diamond Star</option>
                <option value="Diamond DA50">Diamond DA50 RG</option>
                <option value="Diamond DA62">Diamond DA62</option>
                <option value="Mooney M20">Mooney M20</option>
                <option value="American Champion Scout">American Champion 8KCAB Scout</option>
                <option value="Grumman AA-5">Grumman American AA-5</option>
                <option value="Grumman Tiger">Grumman AA-5B Tiger</option>
                <option value="Robin DR400">Robin DR400</option>
                <option value="Socata TB10">Socata TB10 Tobago</option>
                <option value="Socata TB20">Socata TB20 Trinidad</option>
                <option value="Extra EA-300">Extra EA-300</option>
                <option value="Slingsby T67 Firefly">Slingsby T67 Firefly</option>
                <option value="Tecnam P2008">Tecnam P2008</option>
                <option value="Flight Design CTLS">Flight Design CTLS</option>
                <option value="Van's RV-6">Van's Aircraft RV-6</option>
                <option value="Van's RV-7">Van's Aircraft RV-7</option>
                <option value="Van's RV-8">Van's Aircraft RV-8</option>
                <option value="Van's RV-9">Van's Aircraft RV-9</option>
                <option value="Van's RV-10">Van's Aircraft RV-10</option>
              </optgroup>
              <optgroup label="Twin Engine Piston">
                <option value="Beechcraft Baron">Beechcraft Baron</option>
                <option value="Beechcraft Twin Bonanza">Beechcraft Twin Bonanza</option>
                <option value="Cessna 310">Cessna 310</option>
                <option value="Cessna 340">Cessna 340</option>
                <option value="Cessna 414">Cessna 414</option>
                <option value="Cessna 421">Cessna 421</option>
                <option value="Piper Seneca">Piper Seneca</option>
                <option value="Piper Navajo">Piper Navajo</option>
                <option value="Piper Aztec">Piper Aztec</option>
                <option value="Diamond DA42">Diamond DA42 Twin Star</option>
              </optgroup>
              <optgroup label="Helicopters">
                <option value="Bell 206">Bell 206 JetRanger</option>
                <option value="Bell 407">Bell 407</option>
                <option value="Bell 412">Bell 412</option>
                <option value="Bell 429">Bell 429</option>
                <option value="Airbus H120">Airbus H120 (EC120)</option>
                <option value="Airbus H125">Airbus H125 (AS350)</option>
                <option value="Airbus H130">Airbus H130 (EC130)</option>
                <option value="Airbus H135">Airbus H135 (EC135)</option>
                <option value="Airbus H145">Airbus H145 (EC145)</option>
                <option value="Robinson R22">Robinson R22</option>
                <option value="Robinson R44">Robinson R44</option>
                <option value="Robinson R66">Robinson R66</option>
                <option value="Sikorsky S-76">Sikorsky S-76</option>
                <option value="AgustaWestland AW139">AgustaWestland AW139</option>
              </optgroup>
              <optgroup label="Military & Special Aircraft">
                <option value="Lockheed C-130 Hercules">Lockheed C-130 Hercules</option>
                <option value="Boeing KC-135">Boeing KC-135 Stratotanker</option>
                <option value="Airbus A400M">Airbus A400M Atlas</option>
                <option value="Boeing E-3 AWACS">Boeing E-3 AWACS</option>
                <option value="Lockheed P-3 Orion">Lockheed P-3 Orion</option>
                <option value="Boeing P-8 Poseidon">Boeing P-8 Poseidon</option>
                <option value="General Atomics MQ-9">General Atomics MQ-9 Reaper (UAV)</option>
              </optgroup>
              <optgroup label="Vintage & Classic Aircraft">
                <option value="Douglas DC-3">Douglas DC-3</option>
                <option value="Boeing 727">Boeing 727</option>
                <option value="McDonnell Douglas DC-9">McDonnell Douglas DC-9</option>
                <option value="Lockheed L-1011">Lockheed L-1011 TriStar</option>
                <option value="Sud Aviation Caravelle">Sud Aviation Caravelle</option>
                <option value="BAC One-Eleven">BAC One-Eleven</option>
                <option value="Fokker F28">Fokker F28</option>
                <option value="Fokker 100">Fokker 100</option>
              </optgroup>
              <optgroup label="Other Aircraft Types">
                <option value="Glider">Glider/Sailplane</option>
                <option value="Ultralight">Ultralight Aircraft</option>
                <option value="Experimental">Experimental Aircraft</option>
                <option value="Other - Specify in Notes">Other - Specify in Notes</option>
              </optgroup>
            </select>
          </div>
          <div class="heavy-jet-indicator" style="display: none; align-items: center; background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; padding: 8px 12px; border-radius: 8px; font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; box-shadow: 0 2px 4px rgba(5, 150, 105, 0.3);">
            ‚úà >50T MTOW
          </div>
          <div class="notes-field" style="display: none;">
            <label>Notes/Comments (Required if "Other" selected above)</label>
            <input type="text" class="ac-notes" placeholder="Please specify aircraft type, model, or any additional details..." style="width: 100%; padding: 14px 16px; border-radius: 12px; border: 2px solid var(--line); background: #ffffff; color: var(--ink); font-family: inherit; font-size: 14px;" />
          </div>
        </div>`;
      }
      
      sec.innerHTML = `
        <div class="section-title">
          <h3>${label}${typeText?': '+typeText:''}</h3>
          <div class="controls no-print">${locked?'' : '<button class="btn warn" data-remove-section>Remove</button>'}</div>
        </div>
        ${locked && !b737Type ? '' : aircraftDropdown}
        <table>
          <thead>
            <tr>
              <th><b>Flight Role</b></th>
              <th><b>Total Hours</b><span class="sub"><b>(HH:MM)</b></span></th>
              <th><b>Total Block Hours in the Last 12 Months</b><span class="sub"><b>(HH:MM)</b></span></th>
              <th><b>Date of First Flight</b><span class="sub"><b>(Last 12 Months)</b></span></th>
              <th><b>Date of Last Flight</b><span class="sub"><b>(Last 12 Months)</b></span></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="flight-role"><strong>PIC</strong></td>
              <td><input type="text" class="hhmm totHours" placeholder="0:00" /></td>
              <td><input type="text" class="hhmm blk12" placeholder="0:00" /></td>
              <td>
                <div class="date-cell">
                  <input type="date" class="date-inp" />
                  <span class="date-print"></span>
                </div>
              </td>
              <td>
                <div class="date-cell">
                  <input type="date" class="date-inp" />
                  <span class="date-print"></span>
                </div>
              </td>
            </tr>
            <tr>
              <td class="flight-role">SIC</td>
              <td><input type="text" class="hhmm totHours" placeholder="0:00" /></td>
              <td><input type="text" class="hhmm blk12" placeholder="0:00" /></td>
              <td>
                <div class="date-cell">
                  <input type="date" class="date-inp" />
                  <span class="date-print"></span>
                </div>
              </td>
              <td>
                <div class="date-cell">
                  <input type="date" class="date-inp" />
                  <span class="date-print"></span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="footer-fields">
          <div>
            <label>Total Combined Block Hours (HH:MM)</label>
            <div class="kpi"><b class="combined">0:00</b></div>
          </div>
          <div>
            <label>Total Multi‚ÄëPilot Block Hours (HH:MM)</label>
            <input type="text" class="hhmm mp" placeholder="0:00" />
          </div>
          <div>
            <label>Total Night Hours (HH:MM)</label>
            <input type="text" class="hhmm night" placeholder="0:00" />
          </div>
        </div>
      `;
      
      document.getElementById('sections').appendChild(sec);
      
      // Add event listeners for aircraft type selection
      const select = sec.querySelector('.ac-type');
      const notesField = sec.querySelector('.notes-field');
      const heavyJetIndicator = sec.querySelector('.heavy-jet-indicator');
      
      if (select) {
        select.addEventListener('change', function() {
          const aircraftType = this.value;
          
          // Handle notes field
          if (notesField) {
            if (aircraftType === 'Other - Specify in Notes') {
              notesField.style.display = 'block';
            } else {
              notesField.style.display = 'none';
            }
          }
          
          // Handle heavy jet indicator
          if (heavyJetIndicator) {
            if (isHeavyJet(aircraftType)) {
              heavyJetIndicator.style.display = 'flex';
            } else {
              heavyJetIndicator.style.display = 'none';
            }
          }
        });
      }
      
      computeAll();
    }

    // Remove aircraft section
    function removeAircraftSection(btn) {
      btn.closest('.form-section').remove();
      computeAll();
    }

    // Time calculation functions
    function timeToMinutes(timeStr) {
      if (!timeStr || timeStr === '0:00') return 0;
      const parts = timeStr.split(':');
      if (parts.length !== 2) return 0;
      const hours = parseInt(parts[0]) || 0;
      const minutes = parseInt(parts[1]) || 0;
      return hours * 60 + minutes;
    }

    function minutesToTime(totalMinutes) {
      const hours = Math.floor(totalMinutes / 60);
      const minutes = totalMinutes % 60;
      return hours + ':' + (minutes < 10 ? '0' : '') + minutes;
    }

    function computeAll() {
      // Calculate row totals for each aircraft section
      document.querySelectorAll('#sections .form-section').forEach(section => {
        const inputs = section.querySelectorAll('.hhmm');
        const rowTotal = section.querySelector('.row-total');
        let totalMinutes = 0;
        
        inputs.forEach(input => {
          totalMinutes += timeToMinutes(input.value);
        });
        
        if (rowTotal) {
          rowTotal.textContent = minutesToTime(totalMinutes);
        }
      });
      
      // Calculate grand totals
      let combinedTotal = 0;
      let mpTotal = 0;
      let nightTotal = 0;
      
      document.querySelectorAll('#sections .form-section').forEach(section => {
        const inputs = section.querySelectorAll('.hhmm');
        if (inputs.length >= 8) {
          combinedTotal += timeToMinutes(inputs[0].value) + timeToMinutes(inputs[1].value); // PIC + SIC
          mpTotal += timeToMinutes(inputs[1].value); // SIC only
          nightTotal += timeToMinutes(inputs[5].value); // Night
        }
      });
      
      document.getElementById('gtCombined').textContent = minutesToTime(combinedTotal);
      document.getElementById('gtMP').textContent = minutesToTime(mpTotal);
      document.getElementById('gtNight').textContent = minutesToTime(nightTotal);
      
      // Calculate summary table total
      const summaryInputs = document.querySelectorAll('#grandTotalHours').closest('tr').querySelectorAll('.hhmm');
      let summaryTotal = 0;
      summaryInputs.forEach(input => {
        summaryTotal += timeToMinutes(input.value);
      });
      document.getElementById('grandTotalHours').textContent = minutesToTime(summaryTotal);
    }

    // Add event listeners
    document.addEventListener('click', (e) => {
      if (e.target.id === 'btnAddSection') {
        addAircraftSection();
      }
    });

    document.addEventListener('input', (e) => {
      if (e.target.classList.contains('hhmm')) {
        computeAll();
      }
    });

    // Add default Boeing 737 sections on form load using original structure
    function initializeAircraftSections() {
      if (currentStep === 2 && document.getElementById('sections').children.length === 0) {
        const sectionsWrap = document.getElementById('sections');
        sectionsWrap.appendChild(makeAircraftSection({label:'Aircraft Type 1', typeText:'', locked:true, b737Type:'ng-max'}));
        sectionsWrap.appendChild(makeAircraftSection({label:'Aircraft Type 2', typeText:'', locked:true, b737Type:'classic'}));
        sectionsWrap.appendChild(makeAircraftSection({label:'Aircraft Type 3', typeText:'', locked:false}));
      }
    }

    // Original makeAircraftSection function matching the original file exactly
    function makeAircraftSection({label, typeText, locked=false, b737Type=null}) {
      const id = ++sectionCount;
      const sec = document.createElement('section');
      sec.className = 'section'; 
      sec.dataset.sectionId = id; 
      sec.dataset.locked = locked ? '1' : '0';
      
      let aircraftDropdown = '';
      if(b737Type) {
        // Special dropdown for Boeing 737 variants
        aircraftDropdown = `
        <div style="display: grid; grid-template-columns: 400px auto 1fr; gap: 16px; align-items: end;">
          <div>
            <select class="ac-type" ${locked ? 'disabled' : ''} style="${locked ? 'background-color: #f3f4f6; cursor: not-allowed;' : ''}">
              ${b737Type === 'ng-max' ? `
                <option value="Boeing 737 NG/MAX">Boeing 737 NG/MAX</option>
              ` : `
                <option value="Boeing 737 Classic (300-500)">Boeing 737 Classic (300-500)</option>
              `}
            </select>
          </div>
          <div class="heavy-jet-indicator" style="display: flex; align-items: center; background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; padding: 8px 12px; border-radius: 8px; font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; box-shadow: 0 2px 4px rgba(5, 150, 105, 0.3);">
            ‚úà >50T MTOW
          </div>
          <div class="notes-field" style="display: none;">
            <label>Notes/Comments (Required if "Other" selected above)</label>
            <input type="text" class="ac-notes" placeholder="Please specify aircraft type, model, or any additional details..." style="width: 100%; padding: 14px 16px; border-radius: 12px; border: 2px solid var(--line); background: #ffffff; color: var(--ink); font-family: inherit; font-size: 14px;" />
          </div>
        </div>`;
      } else {
        // Regular dropdown for other aircraft - using the same comprehensive list as original
        aircraftDropdown = `
        <div style="display: grid; grid-template-columns: 400px auto 1fr; gap: 16px; align-items: end;">
          <div>
            <select class="ac-type">
              <option value="">Select Aircraft Type...</option>
              <optgroup label="Boeing Commercial Aircraft">
                <option value="Boeing 757-200">Boeing 757-200</option>
                <option value="Boeing 757-300">Boeing 757-300</option>
                <option value="Boeing 767-200">Boeing 767-200</option>
                <option value="Boeing 767-300">Boeing 767-300</option>
                <option value="Boeing 777-200">Boeing 777-200</option>
                <option value="Boeing 777-300">Boeing 777-300</option>
                <option value="Boeing 787-8">Boeing 787-8 Dreamliner</option>
                <option value="Boeing 787-9">Boeing 787-9 Dreamliner</option>
                <option value="Boeing 787-10">Boeing 787-10 Dreamliner</option>
              </optgroup>
              <optgroup label="Airbus Commercial Aircraft">
                <option value="Airbus A319">Airbus A319</option>
                <option value="Airbus A320">Airbus A320</option>
                <option value="Airbus A321">Airbus A321</option>
                <option value="Airbus A330-200">Airbus A330-200</option>
                <option value="Airbus A330-300">Airbus A330-300</option>
                <option value="Airbus A340-200">Airbus A340-200</option>
                <option value="Airbus A340-300">Airbus A340-300</option>
                <option value="Airbus A350-900">Airbus A350-900</option>
                <option value="Airbus A350-1000">Airbus A350-1000</option>
                <option value="Airbus A380">Airbus A380</option>
              </optgroup>
              <optgroup label="Regional Jets & Commercial Aircraft">
                <option value="McDonnell Douglas MD-80">McDonnell Douglas MD-80</option>
                <option value="McDonnell Douglas MD-90">McDonnell Douglas MD-90</option>
                <option value="Embraer E-Jet E170">Embraer E-Jet E170</option>
                <option value="Embraer E-Jet E175">Embraer E-Jet E175</option>
                <option value="Embraer E-Jet E190">Embraer E-Jet E190</option>
                <option value="Embraer E-Jet E195">Embraer E-Jet E195</option>
                <option value="Bombardier CRJ-100">Bombardier CRJ-100</option>
                <option value="Bombardier CRJ-200">Bombardier CRJ-200</option>
                <option value="Bombardier CRJ-700">Bombardier CRJ-700</option>
                <option value="Bombardier CRJ-900">Bombardier CRJ-900</option>
                <option value="Bombardier CRJ-1000">Bombardier CRJ-1000</option>
                <option value="British Aerospace 146">British Aerospace BAe 146</option>
                <option value="Avro RJ70">Avro RJ70</option>
                <option value="Avro RJ85">Avro RJ85</option>
                <option value="Avro RJ100">Avro RJ100</option>
                <option value="Dornier 328JET">Dornier 328JET</option>
                <option value="Fairchild Metro III">Fairchild Metro III</option>
                <option value="Jetstream 41">BAe Jetstream 41</option>
                <option value="Embraer EMB-120">Embraer EMB-120 Brasilia</option>
              </optgroup>
              <optgroup label="Cargo Aircraft">
                <option value="Boeing 747-400F">Boeing 747-400F Freighter</option>
                <option value="Boeing 767-300F">Boeing 767-300F Freighter</option>
                <option value="Boeing 777F">Boeing 777F Freighter</option>
                <option value="Airbus A330-200F">Airbus A330-200F Freighter</option>
                <option value="McDonnell Douglas MD-11F">McDonnell Douglas MD-11F</option>
              </optgroup>
              <optgroup label="Business Jets & Private Aircraft">
                <option value="Gulfstream G150">Gulfstream G150</option>
                <option value="Gulfstream G280">Gulfstream G280</option>
                <option value="Gulfstream G450">Gulfstream G450</option>
                <option value="Gulfstream G500">Gulfstream G500</option>
                <option value="Gulfstream G550">Gulfstream G550</option>
                <option value="Gulfstream G600">Gulfstream G600</option>
                <option value="Gulfstream G650">Gulfstream G650</option>
                <option value="Gulfstream G700">Gulfstream G700</option>
                <option value="Bombardier Global 5000">Bombardier Global 5000</option>
                <option value="Bombardier Global 5500">Bombardier Global 5500</option>
                <option value="Bombardier Global 6000">Bombardier Global 6000</option>
                <option value="Bombardier Global 6500">Bombardier Global 6500</option>
                <option value="Bombardier Global 7500">Bombardier Global 7500</option>
                <option value="Bombardier Challenger 300">Bombardier Challenger 300</option>
                <option value="Bombardier Challenger 350">Bombardier Challenger 350</option>
                <option value="Bombardier Challenger 600">Bombardier Challenger 600</option>
                <option value="Bombardier Challenger 650">Bombardier Challenger 650</option>
                <option value="Dassault Falcon 2000">Dassault Falcon 2000</option>
                <option value="Dassault Falcon 2000EX">Dassault Falcon 2000EX</option>
                <option value="Dassault Falcon 2000LX">Dassault Falcon 2000LX</option>
                <option value="Dassault Falcon 7X">Dassault Falcon 7X</option>
                <option value="Dassault Falcon 8X">Dassault Falcon 8X</option>
                <option value="Dassault Falcon 900">Dassault Falcon 900</option>
                <option value="Cessna Citation Longitude">Cessna Citation Longitude</option>
                <option value="Cessna Citation X">Cessna Citation X</option>
                <option value="Embraer Lineage 1000">Embraer Lineage 1000</option>
                <option value="Embraer Praetor 500">Embraer Praetor 500</option>
                <option value="Embraer Praetor 600">Embraer Praetor 600</option>
              </optgroup>
              <optgroup label="Military & Special Aircraft">
                <option value="Lockheed C-130 Hercules">Lockheed C-130 Hercules</option>
                <option value="Boeing KC-135 Stratotanker">Boeing KC-135 Stratotanker</option>
                <option value="Airbus A400M Atlas">Airbus A400M Atlas</option>
                <option value="Boeing E-3 AWACS">Boeing E-3 AWACS</option>
                <option value="Lockheed P-3 Orion">Lockheed P-3 Orion</option>
                <option value="Boeing P-8 Poseidon">Boeing P-8 Poseidon</option>
              </optgroup>
              <optgroup label="Vintage & Classic Aircraft">
                <option value="Douglas DC-3">Douglas DC-3</option>
                <option value="Boeing 727">Boeing 727</option>
                <option value="McDonnell Douglas DC-9">McDonnell Douglas DC-9</option>
                <option value="Lockheed L-1011 TriStar">Lockheed L-1011 TriStar</option>
                <option value="Sud Aviation Caravelle">Sud Aviation Caravelle</option>
                <option value="BAC One-Eleven">BAC One-Eleven</option>
                <option value="Fokker F28">Fokker F28</option>
                <option value="Fokker 100">Fokker 100</option>
              </optgroup>
              <optgroup label="Other Aircraft Types">
                <option value="Glider">Glider/Sailplane</option>
                <option value="Ultralight">Ultralight Aircraft</option>
                <option value="Experimental">Experimental Aircraft</option>
                <option value="Other - Specify in Notes">Other - Specify in Notes</option>
              </optgroup>
            </select>
          </div>
          <div class="heavy-jet-indicator" style="display: none; align-items: center; background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; padding: 8px 12px; border-radius: 8px; font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; box-shadow: 0 2px 4px rgba(5, 150, 105, 0.3);">
            ‚úà >50T MTOW
          </div>
          <div class="notes-field" style="display: none;">
            <label>Notes/Comments (Required if "Other" selected above)</label>
            <input type="text" class="ac-notes" placeholder="Please specify aircraft type, model, or any additional details..." style="width: 100%; padding: 14px 16px; border-radius: 12px; border: 2px solid var(--line); background: #ffffff; color: var(--ink); font-family: inherit; font-size: 14px;" />
          </div>
        </div>`;
      }
      
      sec.innerHTML = `
        <div class="section-title">
          <h3>${label}${typeText?': '+typeText:''}</h3>
          <div class="controls no-print">${locked?'' : '<button class="btn warn" data-remove-section>Remove</button>'}</div>
        </div>
        ${locked && !b737Type ? '' : aircraftDropdown}
        <table>
          <thead>
            <tr>
              <th><b>Flight Role</b></th>
              <th><b>Total Hours</b><span class="sub"><b>(HH:MM)</b></span></th>
              <th><b>Total Block Hours in the Last 12 Months</b><span class="sub"><b>(HH:MM)</b></span></th>
              <th><b>Date of First Flight</b><span class="sub"><b>(Last 12 Months)</b></span></th>
              <th><b>Date of Last Flight</b><span class="sub"><b>(Last 12 Months)</b></span></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="flight-role"><strong>PIC</strong></td>
              <td><input type="text" class="hhmm totHours" placeholder="0:00" /></td>
              <td><input type="text" class="hhmm blk12" placeholder="0:00" /></td>
              <td>
                <div class="date-cell">
                  <input type="date" class="date-inp" />
                  <span class="date-print"></span>
                </div>
              </td>
              <td>
                <div class="date-cell">
                  <input type="date" class="date-inp" />
                  <span class="date-print"></span>
                </div>
              </td>
            </tr>
            <tr>
              <td class="flight-role">SIC</td>
              <td><input type="text" class="hhmm totHours" placeholder="0:00" /></td>
              <td><input type="text" class="hhmm blk12" placeholder="0:00" /></td>
              <td>
                <div class="date-cell">
                  <input type="date" class="date-inp" />
                  <span class="date-print"></span>
                </div>
              </td>
              <td>
                <div class="date-cell">
                  <input type="date" class="date-inp" />
                  <span class="date-print"></span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="footer-fields">
          <div>
            <label>Total Combined Block Hours (HH:MM)</label>
            <div class="kpi"><b class="combined">0:00</b></div>
          </div>
          <div>
            <label>Total Multi‚ÄëPilot Block Hours (HH:MM)</label>
            <input type="text" class="hhmm mp" placeholder="0:00" />
          </div>
          <div>
            <label>Total Night Hours (HH:MM)</label>
            <input type="text" class="hhmm night" placeholder="0:00" />
          </div>
        </div>
      `;
      return sec;
    }

    // Update the showStep function to initialize aircraft sections
    const originalShowStepFunction = showStep;
    showStep = function(step) {
      originalShowStepFunction(step);
      if (step === 2) {
        setTimeout(initializeAircraftSections, 100);
      }
    };

    // Initialize the form when page loads
    document.addEventListener('DOMContentLoaded', initializeForm);
  </script>
</body>
</html>